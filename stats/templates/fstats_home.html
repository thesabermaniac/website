{% extends 'base.html' %}

{% block title %}fSTATS | The Sabermaniac{% endblock %}

{% block content %}
    <div class="cover" style="position: fixed; height: 100%; width: 100%; top:0; left: 0; z-index:9999; background: white;"></div>
    </div>
    <form action="/fstats" method="get" style="margin-top: 100px">
        <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Included Stats
            </button>
            <select name="include" class="multiselect dropdown-menu" multiple="multiple" aria-labelledby="dropdownMenuButton" style="width: 100px; white-space: normal; height: 240px; overflow: hidden">
                {% for field in field_names %}
                    {% if field|slice:'1' != 'f' and field != 'id' and field != 'player' and field != 'year'%}
                        <option value="{{ field }}">{{ field|capfirst }}</option>
                    {% endif %}
                {% endfor %}
            </select>
            <button type="submit" class="btn btn-secondary btn-sm">Search</button>
        </div>
    </form>
    <div style="width: 90%; margin: 100px auto; height: 100vh;">
        <table id="hitting-stats" class="table table-striped table-bordered">
            <thead>
                <tr>
                    {% for field in included_field_names %}
                        {% if field != 'id'%}
                            <th scope="col">{{ field|capfirst }}</th>
                        {% endif %}
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for stat in object_list %}
                    <tr>
                        {% for field in stat.get_field_names_and_values %}
                            {% if field.name in included_field_names%}
                                {% if field.name == 'AVG' or field.name == 'OBP' or field.name == 'OPS' %}
                                    <td>{{ field.value|floatformat:3 }}</td>
                                {% elif field.value != None and field.name != 'id'%}
                                    <td>{{ field.value }}</td>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <style>
        .multiselect option::before{
            content: '\2610';
            width: 1.3em;
            display: inline-block;
            margin-left: 2px;
        }
        .multiselect option:checked::before{
            content: "\2611";
        }
        .multiselect option{
            display:inline-table;
            width: 50%
        }
        td{white-space: nowrap}
        .nav{position: fixed; width: 100%; top: 0; background: white; z-index: 9}
        table.dataTable thead .sorting, table.dataTable thead .sorting_asc, table.dataTable thead .sorting_desc{background-image: unset}
        .dataTables_wrapper .dataTables_paginate .paginate_button{padding: unset;}
        .dataTables_wrapper .dataTables_paginate .paginate_button:hover{border: none; background: none}
        #hitting-stats_wrapper .col-sm-12{overflow: auto}
    </style>
{% endblock %}

{% block extra_js %}
    <script>
        $(document).ready(function () {
            $('.fstats').addClass('active');
            $('option').mousedown(function(e) {
                e.preventDefault();
                $(this).prop('selected', !$(this).prop('selected'));
                return false;
            });
            $('#hitting-stats').DataTable({
                "lengthMenu": [[10, 25, 50, 100, 250, -1], [10, 25, 50, 100, 250, "All"]],
            });
            $('.cover').hide()
        })
        $(document).on('click', '.dropdown-menu', function (e) {
            e.stopPropagation();
        });
    </script>
{% endblock %}